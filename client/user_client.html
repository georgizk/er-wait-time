<!DOCTYPE html> 
<html>
<head>
  <title>Clinic Wait Times</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="jquery.mobile-1.4.5.min.css" />
  <script src="jquery-1.11.1.min.js"></script>
  <script src="jquery.mobile-1.4.5.min.js"></script>
  <script src="client.js"></script>
</head>

<body>
	<div data-role="page" id="Clinics">
    <div data-role="header"><h1>Clinics</h1></div>
    <div role="main" class="ui-content">
      <ul data-role="listview" data-filter="true" id="clinics_list">
      </ul>    
    </div>
    <div data-role="footer"></div>
  </div>
  
  <div data-role="page" id="WaitTime">
    <div data-role="header">
      <a href="#Clinics" class="ui-btn ui-icon-arrow-l ui-btn-inline ui-btn-icon-left">Back</a>
      <h1><a href="#Clinics">Clinics</a> &gt; <span class="clinicName"></span></h1>
    </div>
    <div role="main" class="ui-content">
    </div>
    <div data-role="footer"></div>
  </div>
  
  <script>
    var config = apiClient.Config("http://127.0.0.1:8080")
    $(document).ready(function() {
      apiClient.getClinics(config, populateClinics)
    })  
    
    function populateClinics(data) {
      if (data.error || !(data.result.length > 0)) {
        return
      }
      var list = $('div#Clinics ul#clinics_list')
      list.empty()
      for (var id in data.result) {
        var clinic = data.result[id]        
        var li = document.createElement('li')
        var a = document.createElement('a')
        $(a).append(document.createTextNode(clinic.Name))
        $(a).click(function(c) {
          return function() { 
            loadClinic(c)
          }
        }(clinic))
        
        $(li).append(a)
        $(list).append(li)
      }
      
      $("body").pagecontainer("change", "#Clinics")
      list.listview().listview("refresh")
    }
    
    function loadClinic(clinic) {
      console.log(clinic)
    }
  </script>
</body>
</html>
